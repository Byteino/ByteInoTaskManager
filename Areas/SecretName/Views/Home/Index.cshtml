@model IEnumerable<ByteInoTaskManager.Areas.SecretName.Models.ViewModels.UserListViewModel>

<div class="main-panel">
    <div class="content-wrapper">
        <div class="row">
            <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <a class="btn btn-success" asp-action="Create">Create User</a>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>@Html.DisplayNameFor(model => model.Email)</th>
                                        <th>@Html.DisplayNameFor(model => model.IsActive)</th>
                                        <th>@Html.DisplayNameFor(model => model.TaskCount)</th>
                                        <th>@Html.DisplayNameFor(model => model.CategoryCount)</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model)
                                    {
                                        <tr>
                                            <td>@item.Email</td>
                                            <td class="@(item.IsActive ? "text-success" : "text-danger")">
                                                @(item.IsActive ? "Active" : "Inactive")
                                            </td>
                                            <td>@item.TaskCount</td>
                                            <td>@item.CategoryCount</td>
                                            <td>
                                                <a class="btn btn-warning"
                                                   asp-action="Edit"
                                                   asp-controller="Home"
                                                   asp-area="SecretName"
                                                   asp-route-id="@item.Id">Edit</a>

                                                <!-- دکمه حذف با data -->
                                                <button type="button"
                                                        class="btn btn-danger btn-delete-user"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#deleteUserModal"
                                                        data-id="@item.Id"
                                                        data-name="@item.Email">
                                                    Delete
                                                </button>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal عمومی -->
<div class="modal fade" id="deleteUserModal" tabindex="-1" aria-labelledby="deleteUserModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteUserModalLabel">Delete User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete <strong id="deleteUserName" class="text-success"></strong>?
            </div>
            <div class="modal-footer">
                <form id="deleteUserForm" method="post">
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const deleteButtons = document.querySelectorAll(".btn-delete-user");
        const deleteUserName = document.getElementById("deleteUserName");
        const deleteUserForm = document.getElementById("deleteUserForm");

        deleteButtons.forEach(btn => {
            btn.addEventListener("click", function () {
                const userId = this.getAttribute("data-id");
                const userName = this.getAttribute("data-name");


                deleteUserName.textContent = userName;


                deleteUserForm.action = `/SecretName/Home/Delete/${userId}`;
            });
        });
    });
</script>

